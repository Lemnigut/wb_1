# Скачивание файлов по артикулам из Excel

Этот скрипт читает Excel-файл, берёт артикулы из колонки C (начиная с 5-й строки) и URL-ы картинок из колонки H (разделённые `;`). Для каждого артикула создаётся папка, и все картинки скачиваются в неё параллельно. В лог выводится прогресс, а все неудачные загрузки сохраняются в `failed_downloads.txt`.

---

## 1. Проверка окружения

Перед запуском нужно убедиться, что на компьютере установлен Python (версия ≥ 3.7).

1. Откройте **терминал** (или **Командную строку** в Windows).

2. Введите:
   ```bash
   python --version
   ```
   или, если не сработало:
   ```bash
   python3 --version
   ```
   - Если увидите что-то вроде `Python 3.12.4`, значит Python установлен.
   - Если выдаётся сообщение об ошибке («команда не найдена»), Python отсутствует или не добавлен в PATH.

> Скрипт написан на Python, поэтому проверки Node.js здесь не требуется.

---

## 2. Установка Python (если ещё нет)

Если Python не найден, скачайте и установите его:

1. Перейдите на официальный сайт:  
   https://www.python.org/downloads/
2. Скачайте **последнюю версию Python 3.x** (Windows, macOS или Linux в зависимости от вашей ОС).
3. На Windows обязательно выберите галочку **«Add Python to PATH»** при установке.
4. После установки снова проверьте в терминале:
   ```bash
   python --version
   ```
   Должна появиться версия, например, `Python 3.12.4`.

---

## 3. Клонирование или копирование скрипта

1. Скачайте или скопируйте файл скрипта `download_from_excel.py` в любую папку на компьютере.
2. Перейдите в эту папку в терминале:
   ```bash
   cd путь/к/папке/со/скриптом
   ```

---

## 4. Создание и активация виртуального окружения (рекомендуется)

Чтобы изолировать зависимости, создайте виртуальное окружение:

1. Создайте окружение:
   ```bash
   python -m venv venv
   ```
2. Активируйте его:
   - **Windows (PowerShell/Command Prompt):**
     ```bash
     venv\Scripts\activate
     ```
   - **macOS/Linux (bash/zsh):**
     ```bash
     source venv/bin/activate
     ```
3. После активации в приглашении терминала появится `(venv)`, и все пакеты будут устанавливаться локально.

---

## 5. Установка зависимостей

Обновите `pip`, затем установите необходимые библиотеки:

```bash
pip install --upgrade pip
pip install pandas requests openpyxl
```

- `pandas` — для чтения Excel-файла.
- `openpyxl` — как движок для работы с `.xlsx`.
- `requests` — для скачивания файлов.

Если установка не проходит из-за прав доступа, добавьте флаг `--user`:
```bash
pip install --user pandas requests openpyxl
```

---

## 6. Подготовка Excel-файла

1. Убедитесь, что ваш Excel-файл:
   - Колонка C (артикулы) заполнена начиная с 5-й строки.
   - Колонка H (URL-ы) в тех же строках содержит строки формата:
     ```
     https://…/1.webp;https://…/2.webp;https://…/3.webp
     ```
   - Файл сохранён в формате `.xlsx`.

2. Поместите этот файл рядом со скриптом **или** укажите полный путь при запуске.

---

## 7. Запуск скрипта

В папке, где лежит `download_from_excel.py`, выполните:

```bash
python download_from_excel.py путь/к/вашему_файлу.xlsx
```

### Примеры

- Если Excel-файл `products.xlsx` находится в текущей папке:
  ```bash
  python download_from_excel.py products.xlsx
  ```

- Чтобы задать число потоков (по умолчанию 8):
  ```bash
  python download_from_excel.py products.xlsx --workers 12
  ```

После запуска:

- Для каждого артикула создаётся папка с его названием.
- Все URL-ы из колонки H разбиваются по `;` и скачиваются в соответствующую папку.
- В консоль выводятся сообщения:
  ```
  [OK]  https://…/1.webp → ART123/1.webp
  [ERR] https://…/2.webp  (TimeoutError или другая ошибка)
  ```
- Все неудачные URL-ы сохраняются в файл `failed_downloads.txt` в той же папке, где скрипт.

---

## 8. Остановка виртуального окружения

Чтобы выйти из виртуального окружения (если активировано):
```bash
deactivate
```

---

## 9. Советы

- Убедитесь в стабильности интернета — при обрывах могут быть ошибки таймаута.
- Если много ошибок при скачивании, попробуйте уменьшить число потоков (`--workers 4`).
- Проверьте `failed_downloads.txt` и при необходимости запустите скрипт повторно для этих URL-ов.

---

Теперь всё готово к использованию. Удачного скачивания!
